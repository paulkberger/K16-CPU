K16 BASIC v2.1t - Test Programs
=================================

--- TEST 1: Basic tokenization & LIST roundtrip ---
10 REM TOKEN TEST
20 PRINT "HELLO WORLD"
30 LET A=42
40 GOTO 60
50 PRINT "SKIPPED"
60 PRINT A
70 END
RUN
LIST

Expected: Program runs, prints HELLO WORLD / 42, LIST shows original text.


--- TEST 2: All statement keywords ---
10 REM STATEMENT KEYWORD TEST
20 CLR
30 LET A=5
40 PRINT A
50 IF A=5 THEN GOTO 70
60 STOP
70 FOR I=1 TO 3
80 PRINT I;
90 NEXT I
100 PRINT
110 GOSUB 200
120 PRINT "BACK"
130 END
200 PRINT "SUB"
210 RETURN
RUN

Expected: 5 / 1 2 3 / SUB / BACK


--- TEST 3: All expression operators ---
10 REM OPERATOR TEST
20 LET A=15
30 LET B=4
40 PRINT A+B
50 PRINT A-B
60 PRINT A*B
70 PRINT A/B
80 PRINT A MOD B
90 PRINT A AND B
100 PRINT A OR B
110 PRINT A XOR B
120 PRINT NOT 0
130 PRINT (A<=15)
140 PRINT (A>=16)
150 PRINT (A<>B)
160 END
RUN

Expected: 19 / 11 / 60 / 3 / 3 / 4 / 15 / 11 / -1 / -1 / 0 / -1


--- TEST 4: Compound comparisons ---
10 LET A=10
20 IF A<=10 THEN PRINT "LE OK"
30 IF A>=10 THEN PRINT "GE OK"
40 IF A<>5 THEN PRINT "NE OK"
50 IF A<=9 THEN PRINT "BAD LE"
60 IF A>=11 THEN PRINT "BAD GE"
70 IF A<>10 THEN PRINT "BAD NE"
80 END
RUN

Expected: LE OK / GE OK / NE OK (no BAD lines)


--- TEST 5: Numeric functions ---
10 PRINT ABS(-42)
20 PRINT ABS(42)
30 PRINT SGN(-5)
40 PRINT SGN(0)
50 PRINT SGN(5)
60 PRINT RND(10)
70 PRINT PEEK($0000)
80 PRINT DEEK($0000)
90 END
RUN

Expected: 42 / 42 / -1 / 0 / 1 / (0-9) / (byte) / (word)


--- TEST 6: String functions ---
10 A$="HELLO"
20 PRINT LEN(A$)
30 PRINT ASC(A$)
40 PRINT CHR$(65)
50 PRINT LEFT$(A$,3)
60 PRINT RIGHT$(A$,3)
70 PRINT MID$(A$,2,3)
80 PRINT STR$(42)
90 PRINT VAL("123")
100 PRINT HEX$($BEEF)
110 END
RUN

Expected: 5 / 72 / A / HEL / LLO / ELL / 42 / 123 / BEEF


--- TEST 7: IF/THEN/ELSE ---
10 LET A=1
20 IF A=1 THEN PRINT "YES" ELSE PRINT "NO"
30 IF A=2 THEN PRINT "NO" ELSE PRINT "YES"
40 IF A=1 THEN GOTO 60
50 PRINT "SKIPPED"
60 PRINT "DONE"
70 END
RUN

Expected: YES / YES / DONE


--- TEST 8: ON GOTO/GOSUB ---
10 FOR I=1 TO 3
20 ON I GOTO 100,200,300
30 NEXT I
40 END
100 PRINT "ONE"
110 GOTO 30
200 PRINT "TWO"
210 GOTO 30
300 PRINT "THREE"
310 GOTO 30
RUN

Expected: ONE / TWO / THREE


--- TEST 9: DATA/READ/RESTORE ---
10 DATA 10,20,30
20 READ A
30 READ B
40 READ C
50 PRINT A;B;C
60 RESTORE
70 READ A
80 PRINT A
90 END
RUN

Expected: 10 20 30 / 10


--- TEST 10: DIM arrays ---
10 DIM A(5)
20 FOR I=0 TO 5
30 LET A(I)=I*I
40 NEXT I
50 FOR I=0 TO 5
60 PRINT A(I);
70 NEXT I
80 PRINT
90 END
RUN

Expected: 0 1 4 9 16 25


--- TEST 11: POKE/PEEK/DOKE/DEEK ---
10 POKE $0400,65
20 PRINT PEEK($0400)
30 DOKE $0402,$1234
40 PRINT DEEK($0402)
50 PRINT HEX$(DEEK($0402))
60 END
RUN

Expected: 65 / 4660 / 1234


--- TEST 12: Nested expressions with tokens ---
10 LET A=10
20 LET B=3
30 PRINT (A>5) AND (B<10)
40 PRINT (A>5) OR (B>10)
50 PRINT NOT (A=5)
60 PRINT (A MOD B) + (A AND B)
70 IF (A>=10) AND (B<=3) THEN PRINT "BOTH"
80 END
RUN

Expected: -1 / -1 / -1 / 3 / BOTH


--- TEST 13: String in PRINT (token inside quotes preserved) ---
10 PRINT "AND OR NOT MOD"
20 PRINT "IF THEN ELSE FOR"
30 PRINT "GOTO GOSUB RETURN"
40 A$="DATA READ RESTORE"
50 PRINT A$
60 END
RUN

Expected: AND OR NOT MOD / IF THEN ELSE FOR / GOTO GOSUB RETURN / DATA READ RESTORE
(Keywords inside quotes must NOT be tokenized)


--- TEST 14: REM preserves rest of line ---
10 REM THIS AND THAT OR NOT
20 REM IF THEN ELSE GOTO GOSUB
30 PRINT "OK"
40 END
RUN
LIST

Expected: Runs OK. LIST shows REM lines with original text intact.


--- TEST 15: Edge cases ---
10 REM EMPTY AND BOUNDARY TESTS
20 PRINT
30 PRINT ""
40 PRINT 0
50 PRINT -1
60 PRINT 32767
70 PRINT -32768
80 LET A=0
90 IF A=0 THEN PRINT "ZERO"
100 FOR I=1 TO 1
110 PRINT "ONCE"
120 NEXT I
130 END
RUN

Expected: (blank) / (blank) / 0 / -1 / 32767 / -32768 / ZERO / ONCE


--- TEST 16: Performance benchmark (FOR loop) ---
10 LET T=PEEK($F000)
20 FOR I=1 TO 1000
30 LET A=I*2+1
40 NEXT I
50 LET T=PEEK($F000)-T
60 PRINT "1000 LOOPS: ";T;" TICKS"
70 PRINT "LAST A=";A
80 END
RUN

Expected: Completes, LAST A=2001. Compare timing with v2.0.
